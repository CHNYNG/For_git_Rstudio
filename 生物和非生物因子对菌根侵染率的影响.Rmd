---
title: "生物和非生物因子对菌根侵染率的影响"
author: "cy"
date: "2023-05-15"
output: html_document
---
# 分析目标
目标主题的确定有利于进一步的分析，每次进来之前先看主题！！！（#后面记得加空格不然不识别

**生物-自身因素-植物自身（host）（host-colonization）**

**谱系是否保守（和数据库对照） 考虑谱系的距离（谱系信号）**

Y (colonization rate) ~ species identity （物种、大小）+ neighbors (邻体数量、类型、或许要分同种异种、是否加权谱系（CNDD系数（不同类型））) +soil+light+…*
 1. 首先，Y侵染率有了，需要的数据species identity应该是每个物种，这是个分类变量？或者分类+连续变量，就是host的侵染率，也有了。下面要解决的问题就是neighbors，那么先筛选出邻体？
 
 

```{r neighbors, include=FALSE}
#加载数据
load("E:/黑石顶测菌根/菌根侵染率/数据整理/tmp/For_git_Rstudio/root_qrl_soil.RData")
HSD <- read.csv("E:/Chu Lab/hsd.species.alive.cy.branch0.csv",header = TRUE,fileEncoding = "GBK" )

# 创建一个空的数据框用于存储结果
result <- data.frame()

# 遍历d数据集的每一行
for (i in 1:nrow(d)) {
  # 计算当前行的点与HSD数据集中所有点的距离
  distances <- sqrt((d$GX[i] - HSD$GX)^2 + (d$GY[i] - HSD$GY)^2)
  
  # 筛选出距离小于10米的点的索引
  indices <- which(distances < 10)
  
  # 如果存在距离小于10米的点，则将这些点添加到结果数据框中
  if (length(indices) > 0) {
    result <- rbind(result, data.frame(d[i,c("TagNew") ], HSD[indices,c("TagNew") ]))
  }
}

#然后，这部分我在服务器上跑了
#把服务器上的数据捞回来

#获取了


```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
